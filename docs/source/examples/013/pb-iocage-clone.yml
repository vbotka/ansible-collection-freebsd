- hosts: iocage
  environment: "{{ freebsd_iocage_runner_env | d({}) }}"

  tasks:

    - name: Clone from basejail
      register: out
      vbotka.freebsd.iocage:
        state: cloned
        clone_from: "{{ item.clone_from }}"
        name: "{{ item.name }}"
        properties: "{{ [properties, item.properties] | combine }}"
      loop: "{{ clones }}"
      loop_control:
        label: "{{ item.name }} {{ item.clone_from }}"

    - name: Debug
      when: debug | d(false) | bool
      ansible.builtin.debug:
        var: out
      
    - name: Display lists of bases, plugins, templates, and jails.
      ansible.builtin.debug:
        msg: |-
          releases: {{ iocage_releases }}
          plugins: {{ iocage_plugins.keys() | list }}
          templates: {{ iocage_templates.keys() | list }}
          jails: {{ iocage_jails.keys() | list }}
