- name: Create Ansible client templates.
  hosts: iocage
  environment: "{{ freebsd_iocage_runner_env | d({}) }}"

  vars:

    debug: false
    debug2: false

  tasks:

    - name: Setup
      tags: [always, setup]
      import_tasks: tasks/setup.yml

    - name: Create basejails
      tags: create
      import_tasks: tasks/create.yml

    - name: Start basejails
      tags: start
      import_tasks: tasks/start.yml

    - name: Install packages
      tags: pkg
      import_tasks: tasks/pkg.yml

    - name: Create user
      tags: user
      import_tasks: tasks/user.yml

    - name: Configure public keys
      tags: pk
      import_tasks: tasks/pk.yml

    - name: Configure sudo
      tags: sudo
      import_tasks: tasks/sudo.yml

    - name: Configure sshd
      tags: sshd
      import_tasks: tasks/sshd.yml

    - name: Stop basejails
      tags: stop
      import_tasks: tasks/stop.yml

    - name: Set template
      tags: template
      import_tasks: tasks/template.yml
