#!/usr/local/bin/python

import json
import os
from subprocess import Popen, PIPE

data = {}

my_env = os.environ.copy()
my_env.update({'CRYPTOGRAPHY_OPENSSL_NO_LEGACY': '1'})
cmd = ['iocage', 'list', '--long']
p = Popen(cmd, stdout=PIPE, stderr=PIPE, env=my_env)

stdout, stderr = p.communicate()
data['jails'] = stdout.decode("utf-8")
json_formatted_str = json.dumps(data, indent=2)

print(json_formatted_str)
